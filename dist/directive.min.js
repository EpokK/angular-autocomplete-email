/*!
 * angular-directive-boilerplate
 * 
 * Version: 0.0.8 - 2015-03-28T18:56:46.303Z
 * License: MIT
 */
"use strict";angular.module("angular-autocomplete-email",[]).filter("autocompleteFilter",function(){return function(e,n){var t=[];if(n&&n.length>0)for(var a=e.length-1;a>=0;a--){var l=e[a];"undefined"!=typeof l.value&&(-1!==l.value.toLowerCase().indexOf(n.toLowerCase())||-1!==l.label.toLowerCase().indexOf(n.toLowerCase()))&&t.push(l)}return t.sort(function(e,t){return e.label.toLowerCase().score(n)+e.value.toLowerCase().score(n)<t.label.toLowerCase().score(n)+t.value.toLowerCase().score(n)}),t}}).directive("autocompleteEmail",function(e,n){var t=/([.^\S]+@[.^\S]+\.[.^\S]+)/gi,a=9,l=13,i=8,o=function(e,n){var t;return t=e.length>0?e:n},u=function(e,n){var t;return t=e.length>0?e+" <"+n+">":n},r=function(e){return e.replace(/</g,"").replace(/>/g,"").replace(/"/g,"").replace(/'/g,"").replace(/,/g,"").trim()},c=function(e,n,a){var l=e.match(t);if(n=n||[],l){for(var i=e,c=0;c<l.length;c++)if(i){var s=r(l[c]),m=i.split(s),p=r(m[0]),f={value:u(p,s),label:o(p,s),edit:!1};0===c&&a>=0?n[a]=f:n.push(f),i=m[1]}}else a&&(n[a].newValue="");return n};return{restrict:"EA",templateUrl:"../src/input.html",replace:!0,scope:!1,link:function(t,o){t.autocompleteFiltered=[],t.onSubmit=function(e,n){var a=t.emails.indexOf(e),l=angular.copy(e.newValue),i=c(l,t.emails,a);i.length?t.emails=i:t.onRemove(t.emails.indexOf(e)),n&&t.createNewInput()},t.selectFirstAutocomplete=function(){},t.onBlur=function(e){e.newValue.length&&t.onSubmit(e,!1)},t.onEdit=function(e){e.edit=!0,e.newValue=angular.copy(e.value)},t.onRemove=function(e){t.emails.splice(e,1)},t.onMouseDown=function(e){t.onClick(e)},t.createNewInput=function(){var e=t.getLastInput();angular.isDefined(e)||t.emails.push({value:"",label:"",newValue:"",edit:!0}),t.focusLastInput()},t.onClick=function(e){e.target==o[0].firstElementChild&&t.createNewInput()},t.onAddEmail=function(e){t.emails.push({value:e.value,label:e.label,edit:!1})},t.onClose=function(){},t.getLastInput=function(){var e=o.find("input"),n=e.length;return e[n-1]},t.focusLastInput=function(){e(function(){var e=t.getLastInput();e&&t.getLastInput().focus()},200)},t.onChange=function(e){t.newValue=e.newValue,t.autocompleteFiltered=n("autocompleteFilter")(t.autocomplete,t.newValue)},t.onKeyDown=function(e,n){switch(e.keyCode){case i:var o=n.newValue,u=t.emails;0===o.length&&u.length>0&&this.onRemove(u.length-2);break;case a:case l:e.preventDefault(),e.stopPropagation()}},t.onKeyUp=function(e,n){switch(e.keyCode){case l:case a:t.onSubmit(n,!0)}}}}}),angular.module("angular-autocomplete-email").run(["$templateCache",function(e){e.put("input.html",'<div class="container-email"><div class="input-email" ng-mousedown="onMouseDown($event)"><span ng-repeat="email in emails"><span class="label-email" ng-attr-title="{{email.value}}" ng-dblclick="onEdit(email)" ng-if="!!!email.edit"><span>{{email.label}}</span> <a ng-click="onRemove($index)">x</a></span><form class="form-email" ng-submit="onSubmit(email, true)" ng-if="!!email.edit"><input class="edit-email" type="text" ng-model="email.newValue" ng-blur="onBlur(email)" ng-keydown="onKeyDown($event, email)" ng-keyup="onKeyUp($event, email)" ng-change="onChange(email)"></form></span></div><ul class="autocomplete-email" ng-show="autocompleteFiltered.length"><li ng-repeat="email in autocompleteFiltered"><a href="" ng-click="onAddEmail(email)">{{email.value}}</a></li></ul></div>')}]);