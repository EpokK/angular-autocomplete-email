/*!
 * angular-directive-boilerplate
 * 
 * Version: 0.0.8 - 2015-03-27T20:57:56.734Z
 * License: MIT
 */
"use strict";angular.module("angular-autocomplete-email",[]).directive("autocompleteEmail",function(e){var n=/([.^\S]+@[.^\S]+\.[.^\S]+)/gi,a=9,t=13,l=8,i=function(e,n){var a;return a=e.length>0?e:n},u=function(e,n){var a;return a=e.length>0?e+" <"+n+">":n},o=function(e){return e.replace(/</g,"").replace(/>/g,"").replace(/"/g,"").replace(/'/g,"").replace(/,/g,"").trim()},c=function(e,a,t){var l=e.match(n);if(a=a||[],l)for(var c=e,r=0;r<l.length;r++)if(c){var m=o(l[r]),s=c.split(m),p=o(s[0]),g={value:u(p,m),label:i(p,m),edit:!1};0===r&&t>=0?a[t]=g:a.push(g),c=s[1]}return a};return{restrict:"EA",templateUrl:"../src/input.html",replace:!0,scope:!1,link:function(n,i){n.onSubmit=function(e){var a=n.emails.indexOf(e),t=angular.copy(e.newValue),l=c(t,n.emails,a);l.length?n.emails=l:n.onRemove(n.emails.indexOf(e)),n.createNewInput()},n.onBlur=function(e){n.onSubmit(e)},n.onEdit=function(e){e.edit=!0,e.newValue=angular.copy(e.value)},n.onRemove=function(e){n.emails.splice(e,1)},n.onMouseDown=function(e){n.onClick(e)},n.createNewInput=function(){var e=n.getLastInput();angular.isDefined(e)||n.emails.push({value:"",label:"",newValue:"",edit:!0}),n.focusLastInput()},n.onClick=function(e){e.target==i[0].firstElementChild&&n.createNewInput()},n.onAddEmail=function(e){n.emails.push({value:e.value,label:e.label,edit:!1})},n.onClose=function(){},n.getLastInput=function(){var e=i.find("input"),n=e.length;return e[n-1]},n.focusLastInput=function(){e(function(){var e=n.getLastInput();e&&n.getLastInput().focus()},200)},n.onKeyDown=function(e,i){switch(e.keyCode){case l:var u=i.newValue,o=n.emails;0===u.length&&o.length>0&&this.onRemove(o.length-2);break;case a:case t:e.preventDefault(),e.stopPropagation()}},n.onKeyUp=function(e,l){switch(e.keyCode){case t:case a:n.onSubmit(l)}}}}}),angular.module("angular-autocomplete-email").run(["$templateCache",function(e){e.put("input.html",'<div><div class="input-email" ng-mousedown="onMouseDown($event)"><span ng-repeat="email in emails"><span class="label-email" ng-attr-title="{{email.value}}" ng-dblclick="onEdit(email)" ng-if="!!!email.edit"><span>{{email.label}}</span> <a ng-click="onRemove($index)">x</a></span><form class="form-email" ng-submit="onSubmit(email)" ng-if="!!email.edit"><input class="edit-email" type="text" ng-model="email.newValue" ng-blur="onBlur(email)" ng-keydown="onKeyDown($event, email)" ng-keyup="onKeyUp($event, email)"></form></span></div><ul class="autocomplete-email" ng-show="open"><li ng-repeat="email in autocomplete"><a href="" ng-click="onAddEmail(email)">{{email.value}}</a></li></ul></div>')}]);